zerothorder_Wexp = W`(nc[a[0, n], a[1, n]]*(\[Mu][n]^2 - Vz*Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2] + \[CapitalDelta]*Sqrt[-\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]))/Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]`;

firstorder_hopping_Wexp = W`(tso*nc[a[1, n], a[1, 1 + n]]*(E^(I*\[Phi][1 + n])*Sqrt[\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[-\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]] + E^(I*\[Phi][n])*Sqrt[-\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]]) - 
tso*nc[a[0, n], a[0, 1 + n]]*(E^(I*\[Phi][n])*Sqrt[\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[-\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]] + E^(I*\[Phi][1 + n])*Sqrt[-\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]]) + 
t*nc[a[0, n], a[1, 1 + n]]*(E^(I*\[Phi][1 + n])*Sqrt[-\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[-\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]] - E^(I*\[Phi][n])*Sqrt[\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]]) + 
t*nc[a[0, 1 + n], a[1, n]]*(E^(I*\[Phi][n])*Sqrt[-\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[-\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]] - E^(I*\[Phi][1 + n])*Sqrt[\[Mu][n] + Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]]*Sqrt[\[Mu][1 + n] + Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]]))/
(2*E^((I/2)*(\[Phi][n] + \[Phi][1 + n]))*(\[CapitalDelta]^2 + \[Mu][n]^2)^(1/4)*(\[CapitalDelta]^2 + \[Mu][1 + n]^2)^(1/4))`;

firstorder_int_Wexp = W`U + V - (U*nc[a[0, n], a[1, n]])/2 - (U*nc[a[0, 1 + n], a[1, 1 + n]])/2 + (U*\[Mu][n])/(2*Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]) + (V*\[Mu][n])/Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2] - (U*nc[a[0, n], a[1, n]]*\[Mu][n])/(2*Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]) - 
(V*nc[a[0, n], a[1, n]]*\[Mu][n])/Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2] + (U*\[Mu][1 + n])/(2*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]) + (V*\[Mu][1 + n])/Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2] - (U*nc[a[0, 1 + n], a[1, 1 + n]]*\[Mu][1 + n])/(2*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]) - 
(V*nc[a[0, 1 + n], a[1, 1 + n]]*\[Mu][1 + n])/Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2] + (V*\[Mu][n]*\[Mu][1 + n])/(Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]) - 
(V*nc[a[0, n], a[1, n]]*\[Mu][n]*\[Mu][1 + n])/(Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]) - (V*nc[a[0, 1 + n], a[1, 1 + n]]*\[Mu][n]*\[Mu][1 + n])/(Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2]) - 
(V*nc[a[0, n], a[0, 1 + n], a[1, n], a[1, 1 + n]]*\[Mu][n]*\[Mu][1 + n])/(Sqrt[\[CapitalDelta]^2 + \[Mu][n]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][1 + n]^2])`;


secondorder_N3_nonint_Wexp = W`(E^(I*\[Phi][3])*nc[a[0, 1], a[1, 1]]*(E^((2*I)*\[Phi][1])*(t^2 + tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]] + E^((2*I)*\[Phi][2])*(t^2 + tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]] + 2*E^(I*(\[Phi][1] + \[Phi][2]))*(t^2*(-(\[Mu][1]*\[Mu][2]) + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]) - tso^2*(\[Mu][1]*\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2])))*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2] + E^(I*\[Phi][1])*nc[a[0, 3], a[1, 3]]*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*(E^((2*I)*\[Phi][2])*(t^2 + tso^2)*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^((2*I)*\[Phi][3])*(t^2 + tso^2)*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + 2*E^(I*(\[Phi][2] + \[Phi][3]))*(t^2*(-(\[Mu][2]*\[Mu][3]) + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]) - tso^2*(\[Mu][2]*\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]))) + E^((I/2)*(\[Phi][1] + \[Phi][3]))*(\[CapitalDelta]^2 + \[Mu][1]^2)^(1/4)*(\[CapitalDelta]^2 + \[Mu][3]^2)^(1/4)*(nc[a[0, 1], a[1, 3]]*(E^(I*(\[Phi][1] + \[Phi][3]))*(t^2 - tso^2)*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][2] + \[Phi][3]))*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*(tso^2*(-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]) + t^2*(\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]))*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^((2*I)*\[Phi][2])*(t^2 - tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + \[Phi][2]))*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*(t^2*(-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]) + tso^2*(\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]))*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]) + nc[a[0, 3], a[1, 1]]*(E^((2*I)*\[Phi][2])*(t^2 - tso^2)*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + \[Phi][2]))*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*(tso^2*(-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]) + t^2*(\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]))*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + \[Phi][3]))*(t^2 - tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][2] + \[Phi][3]))*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*(t^2*(-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]) + tso^2*(\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]))*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]) + 2*t*tso*(nc[a[1, 1], a[1, 3]]*(E^(I*(\[Phi][2] + \[Phi][3]))*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*\[Mu][2]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] - E^(I*(\[Phi][1] + \[Phi][3]))*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + \[Phi][2]))*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*\[Mu][2]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^((2*I)*\[Phi][2])*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]) + nc[a[0, 1], a[0, 3]]*(-(E^(I*(\[Phi][1] + \[Phi][2]))*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*\[Mu][2]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]) + E^((2*I)*\[Phi][2])*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] - E^(I*(\[Phi][2] + \[Phi][3]))*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*\[Mu][2]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] - E^(I*(\[Phi][1] + \[Phi][3]))*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]))) + nc[a[0, 2], a[1, 2]]*(E^(I*(2*\[Phi][1] + \[Phi][3]))*(t^2 + tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2] + E^(I*(2*\[Phi][2] + \[Phi][3]))*(t^2 + tso^2)*Sqrt[-\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[\[Mu][1] + Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2] + E^(I*(\[Phi][1] + 2*\[Phi][2]))*(t^2 + tso^2)*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + 2*\[Phi][3]))*(t^2 + tso^2)*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[-\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[\[Mu][2] + Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]]*Sqrt[-\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]]*Sqrt[\[Mu][3] + Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2]] + E^(I*(\[Phi][1] + \[Phi][2] + \[Phi][3]))*(t^2*(4*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2] - 2*\[Mu][2]*(Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*\[Mu][3] + \[Mu][1]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2])) - 2*tso^2*(2*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2] + \[Mu][2]*(Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*\[Mu][3] + \[Mu][1]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2])))))/(4*E^(I*(\[Phi][1] + \[Phi][2] + \[Phi][3]))*Vz*Sqrt[\[CapitalDelta]^2 + \[Mu][1]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][2]^2]*Sqrt[\[CapitalDelta]^2 + \[Mu][3]^2])`;

secondorder_N3_int_Wexp = nothing;
